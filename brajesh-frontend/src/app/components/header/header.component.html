<header class="main-header minimal-header">
  <div class="header-container minimal-header-container">
    <div class="header-logo yoga-logo">
      <img *ngIf="showLogo" [src]="logoUrl" alt="Logo" (error)="onLogoError($event)" />
      <span *ngIf="!showLogo" class="brand">Logo</span>
    </div>
    <nav class="header-nav minimal-nav">
      <ul>
        <li *ngFor="let item of navigationData?.menuItems">
          <a *ngIf="!item.hasDropdown && !item.isExternal"
             [routerLink]="item.url"
             routerLinkActive="active"
             [routerLinkActiveOptions]="{ exact: true }">
            {{ item.label }}
          </a>
          <a *ngIf="!item.hasDropdown && item.isExternal"
             [href]="item.url" target="_blank">
            {{ item.label }}
          </a>
          <div *ngIf="item.hasDropdown" class="dropdown">
            <span class="dropdown-label">{{ item.label }}</span>
            <ul class="dropdown-menu">
              <li *ngFor="let drop of item.dropdownItems">
                <a *ngIf="!drop.isExternal" [routerLink]="drop.url">{{ drop.label }}</a>
                <a *ngIf="drop.isExternal" [href]="drop.url" target="_blank">{{ drop.label }}</a>
              </li>
            </ul>
          </div>
        </li>
        <!-- Show Login link only if NOT logged in -->
        <li *ngIf="!(isLoggedIn$ | async)">
          <a [routerLink]="'/login'">Login</a>
        </li>
        <!-- Show Avatar only if logged in -->
        <li *ngIf="isLoggedIn$ | async as loggedIn" class="avatar-container" (click)="logout()" style="cursor: pointer;" title="Logout">
          <ng-container *ngIf="userProfile$ | async as user">
            <!-- Syncfusion Avatar with Profile Picture or Fallback -->
            <span class="e-avatar e-avatar-circle">
              <img *ngIf="user?.picture" [src]="user.picture" alt="User Avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;"/>
              <!-- Fallback to first letter of username if no picture -->
              <ng-container *ngIf="!user?.picture">
                {{ user?.username ? user.username[0].toUpperCase() : 'U' }}
              </ng-container>
            </span>
          </ng-container>
           <!-- Fallback if user profile is somehow null while logged in -->
           <ng-container *ngIf="!(userProfile$ | async)">
             <span class="e-avatar e-avatar-circle">U</span>
           </ng-container>
        </li>
      </ul>
    </nav>
  </div>
</header>